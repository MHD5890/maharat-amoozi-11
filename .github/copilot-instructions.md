# Copilot Instructions for maharat-amoozi

## معماری پروژه
- پروژه با Next.js و ساختار app router پیاده‌سازی شده است.
- دیتابیس MongoDB با مدل اصلی `Person` متصل است (فایل `models/Person.js`).
- اتصال به دیتابیس از طریق `lib/dbConnect.js` انجام می‌شود و باید متغیر `MONGODB_URI` در `.env.local` تنظیم شود.
- APIها در مسیر `app/api/persons/` برای مدیریت اطلاعات و `app/api/export/` برای خروجی اکسل قرار دارند.

## پنل مدیریت
- صفحه مدیریت در `app/admin/page.tsx` قرار دارد و اطلاعات را از API دریافت می‌کند.
- عملیات حذف، ویرایش و خروجی اکسل از طریق دکمه‌های موجود در این صفحه انجام می‌شود.
- برای خروجی اکسل، درخواست به `/api/export` ارسال می‌شود و فایل اکسل با اطلاعات ثبت‌شده دانلود می‌شود.

## الگوهای مهم
- مدل `Person` شامل فیلدهای کلیدی مانند firstName، lastName، nationalId (یکتا)، و سایر اطلاعات فردی است.
- تمام عملیات مدیریتی (GET, PUT, DELETE) فقط برای مدیر مجاز است و با تابع `checkAdmin` کنترل می‌شود.
- برای ویرایش یا حذف رکورد، از API `/api/persons/[id]` استفاده کنید.
- برای افزودن رکورد جدید، از API `/api/persons` با متد POST استفاده کنید.

## توسعه و اجرا
- برای اجرای پروژه: `npm run dev`
- برای اتصال به دیتابیس، مقداردهی `MONGODB_URI` در `.env.local` الزامی است.
- برای افزودن وابستگی اکسل، از پکیج `xlsx` استفاده شده است.

## مثال‌های کلیدی
- دریافت لیست افراد:
  ```js
  fetch('/api/persons')
  ```
- حذف رکورد:
  ```js
  fetch(`/api/persons/${id}`, { method: 'DELETE' })
  ```
- خروجی اکسل:
  ```js
  fetch('/api/export')
  ```

## نکات ویژه
- تمام APIهای مدیریتی نیاز به احراز هویت مدیر دارند (بررسی با `checkAdmin`).
- داده‌ها در کالکشن person ذخیره می‌شوند (توجه به پارامتر سوم مدل Mongoose).
- برای توسعه، به ساختار پوشه‌ها و نام‌گذاری فایل‌ها دقت کنید.

---
این راهنما برای افزایش بهره‌وری هوش مصنوعی و توسعه‌دهندگان در این پروژه تهیه شده است. اگر بخش‌هایی نیاز به توضیح بیشتر دارد، لطفاً بازخورد دهید.